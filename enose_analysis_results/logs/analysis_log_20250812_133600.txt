E-NOSE COCOA BEAN CLASSIFICATION WITH MULTIPLE ML MODELS
======================================================================
Analysis started at: 2025-08-12 13:36:00
Results will be saved to: enose_analysis_results
======================================================================
Loading and preprocessing data...
Training data shape: (130, 15)
Testing data shape: (10, 15)
Training classes: ['WF' 'Ad' 'UF']
Training class distribution:
class
Ad    60
WF    40
UF    30
Name: count, dtype: int64
Unclassified samples to predict: ['X1', 'X2', 'X3', 'X4', 'X5', 'X6', 'X7', 'X8', 'X9', 'X10']

==================================================
EXPLORATORY DATA ANALYSIS
==================================================

Training Data Statistics:
                ch0           ch1           ch2           ch3  ...          ch10          ch11          ch12         ch13
count    130.000000    130.000000    130.000000    130.000000  ...    130.000000    130.000000    130.000000   130.000000
mean   13402.608623   8637.869157  35541.863237  29018.411557  ...  12027.699238   5709.738687  32840.960504  3113.538550
std     5706.669558   6821.888319  15313.220091   6633.968133  ...   4416.265356   2992.019310  14066.700902   613.814492
min     5084.054294   2149.330500  12005.522719  16179.081820  ...   5779.140141   1239.243108   7375.124645  1968.592680
25%     8743.633109   3810.997090  23452.329117  23784.036629  ...   8915.382847   3254.827742  21691.132706  2649.166114
50%    11850.507517   5682.365827  34305.081014  28288.957495  ...  10357.040500   4873.540043  29783.920073  3122.696372
75%    17740.814240  13994.722389  43496.155420  35684.980966  ...  14639.712642   8427.290890  44903.348458  3649.888319
max    25508.871521  32783.814275  78648.664073  40549.214519  ...  24537.035018  13982.151828  65480.362365  4401.078142

[8 rows x 14 columns]

✅ Class distribution plot saved to: enose_analysis_results/plots/01_class_distribution_20250812_133600.png
✅ Sample distribution plot saved to: enose_analysis_results/plots/02_sample_distribution_20250812_133600.png
✅ Correlation matrix plot saved to: enose_analysis_results/plots/03_correlation_matrix_20250812_133600.png
✅ Sensor boxplot saved to: enose_analysis_results/plots/04_sensor_boxplot_20250812_133600.png
✅ Feature importance plot saved to: enose_analysis_results/plots/05_feature_importance_20250812_133600.png
✅ PCA visualization plot saved to: enose_analysis_results/plots/06_pca_visualization_20250812_133600.png
✅ Class means comparison plot saved to: enose_analysis_results/plots/07_class_means_comparison_20250812_133600.png

Training Data Class-wise Feature Analysis:
========================================

Mean sensor values by class (training data):
                ch0           ch1           ch2           ch3  ...          ch10         ch11          ch12         ch13
class                                                          ...                                                      
Ad     12859.733525   6794.706425  35911.282043  29440.178168  ...  11437.433164  5726.732348  32858.931317  3211.861946
UF     22153.885628  19528.420378  54179.815027  38156.956179  ...  18596.052217  9925.320227  52707.128986  3747.762379
WF      7653.463516   3234.699838  21009.271187  21531.853173  ...   7986.833613  2522.562039  17914.377922  2490.385587

[3 rows x 14 columns]

✅ Class means saved to: enose_analysis_results/data/class_means_20250812_133600.csv

Class separability analysis (ANOVA F-statistic for each feature):
ch0: F=409.75, p=4.05e-56
ch1: F=291.55, p=3.41e-48
ch2: F=105.40, p=1.05e-27
ch3: F=328.68, p=6.16e-51
ch4: F=238.43, p=1.00e-43
ch5: F=19.04, p=5.87e-08
ch6: F=385.25, p=1.19e-54
ch7: F=315.63, p=5.28e-50
ch8: F=256.77, p=2.38e-45
ch9: F=331.53, p=3.89e-51
ch10: F=228.25, p=8.86e-43
ch11: F=277.01, p=4.85e-47
ch12: F=276.06, p=5.79e-47
ch13: F=87.62, p=1.23e-24

✅ ANOVA results saved to: enose_analysis_results/data/anova_results_20250812_133600.csv

Feature Distribution Comparison (Training vs Unclassified Samples):
============================================================
Feature  Train Mean   Test Mean    Train Std    Test Std    
------------------------------------------------------------
ch0      13402.61     16855.74     5684.68      9045.62     
ch1      8637.87      13148.83     6795.60      11174.04    
ch2      35541.86     30214.49     15254.21     11300.89    
ch3      29018.41     32432.08     6608.40      9803.32     
ch4      21133.99     23276.12     3230.28      4553.53     
ch5      38953.30     37460.71     1732.70      2904.90     
ch6      11602.30     14849.58     5036.30      7976.12     
ch7      3805.61      5625.94      1894.52      3562.00     
ch8      36588.69     52792.89     24825.62     43501.48    
ch9      9426.85      12764.36     4268.68      6857.09     
ch10     12027.70     14376.73     4399.25      6766.22     
ch11     5709.74      7526.55      2980.49      3193.53     
ch12     32840.96     35673.68     14012.49     18944.80    
ch13     3113.54      3083.24      611.45       584.65      

✅ Feature comparison saved to: enose_analysis_results/data/feature_comparison_20250812_133600.csv

==================================================
DATA PREPARATION
==================================================
Training set size: (91, 14)
Validation set size: (39, 14)
Unclassified samples to predict: (10, 14)
Sample IDs: ['X1', 'X2', 'X3', 'X4', 'X5', 'X6', 'X7', 'X8', 'X9', 'X10']

==================================================
MODEL TRAINING AND EVALUATION
==================================================

Training Random Forest...
Validation Accuracy: 0.9744
Validation F1-Score: 0.9741
CV Accuracy: 0.9778 (+/- 0.0544)

Training Support Vector Machine...
Validation Accuracy: 0.9744
Validation F1-Score: 0.9741
CV Accuracy: 0.9673 (+/- 0.0883)

Training Logistic Regression...
Validation Accuracy: 0.9744
Validation F1-Score: 0.9741
CV Accuracy: 0.9889 (+/- 0.0444)

Training Gradient Boosting...
Validation Accuracy: 0.9487
Validation F1-Score: 0.9488
CV Accuracy: 0.9778 (+/- 0.0544)

Training K-Nearest Neighbors...
Validation Accuracy: 0.9744
Validation F1-Score: 0.9741
CV Accuracy: 0.9778 (+/- 0.0544)

Training Naive Bayes...
Validation Accuracy: 0.9744
Validation F1-Score: 0.9747
CV Accuracy: 0.9450 (+/- 0.0703)

Training Neural Network...
Validation Accuracy: 0.9487
Validation F1-Score: 0.9477
CV Accuracy: 0.9667 (+/- 0.0889)

Training Decision Tree...
Validation Accuracy: 0.9744
Validation F1-Score: 0.9741
CV Accuracy: 0.9778 (+/- 0.0544)

✅ Model performance results saved to: enose_analysis_results/data/model_performance_20250812_133600.csv

==================================================
HYPERPARAMETER TUNING
==================================================

Tuning Random Forest...
Best parameters: {'max_depth': None, 'min_samples_split': 2, 'n_estimators': 50}
Best CV score: 0.8927

Tuning Support Vector Machine...
Best parameters: {'C': 1, 'gamma': 'scale', 'kernel': 'rbf'}
Best CV score: 0.9005

Tuning Gradient Boosting...
Best parameters: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 50}
Best CV score: 0.9154

✅ Hyperparameter tuning results saved to: enose_analysis_results/data/hyperparameter_tuning_20250812_133600.csv

==================================================
PREDICTING UNCLASSIFIED SAMPLES
==================================================

Random Forest:
Average Prediction Confidence: 0.9390
  X1: UF (confidence: 1.000)
  X2: UF (confidence: 1.000)
  X3: UF (confidence: 0.960)
  X4: UF (confidence: 0.970)
  X5: UF (confidence: 0.990)
  X6: WF (confidence: 0.740)
  X7: WF (confidence: 1.000)
  X8: WF (confidence: 0.740)
  X9: Ad (confidence: 1.000)
  X10: Ad (confidence: 0.990)

Support Vector Machine:
Average Prediction Confidence: 0.8567
  X1: UF (confidence: 0.648)
  X2: UF (confidence: 0.747)
  X3: UF (confidence: 0.700)
  X4: UF (confidence: 0.872)
  X5: UF (confidence: 0.886)
  X6: WF (confidence: 0.937)
  X7: WF (confidence: 0.965)
  X8: WF (confidence: 0.883)
  X9: Ad (confidence: 0.976)
  X10: Ad (confidence: 0.954)

Logistic Regression:
Average Prediction Confidence: 0.9457
  X1: UF (confidence: 1.000)
  X2: UF (confidence: 1.000)
  X3: UF (confidence: 0.840)
  X4: UF (confidence: 0.847)
  X5: UF (confidence: 0.872)
  X6: WF (confidence: 0.999)
  X7: WF (confidence: 1.000)
  X8: WF (confidence: 0.999)
  X9: Ad (confidence: 0.962)
  X10: Ad (confidence: 0.937)

Gradient Boosting:
Average Prediction Confidence: 1.0000
  X1: UF (confidence: 1.000)
  X2: UF (confidence: 1.000)
  X3: UF (confidence: 1.000)
  X4: UF (confidence: 1.000)
  X5: UF (confidence: 1.000)
  X6: WF (confidence: 1.000)
  X7: WF (confidence: 1.000)
  X8: WF (confidence: 1.000)
  X9: Ad (confidence: 1.000)
  X10: Ad (confidence: 1.000)

K-Nearest Neighbors:
Average Prediction Confidence: 0.8800
  X1: UF (confidence: 1.000)
  X2: UF (confidence: 1.000)
  X3: UF (confidence: 0.600)
  X4: UF (confidence: 0.600)
  X5: UF (confidence: 0.600)
  X6: WF (confidence: 1.000)
  X7: WF (confidence: 1.000)
  X8: WF (confidence: 1.000)
  X9: Ad (confidence: 1.000)
  X10: Ad (confidence: 1.000)

Naive Bayes:
Average Prediction Confidence: 1.0000
  X1: UF (confidence: 1.000)
  X2: UF (confidence: 1.000)
  X3: UF (confidence: 1.000)
  X4: UF (confidence: 1.000)
  X5: UF (confidence: 1.000)
  X6: WF (confidence: 1.000)
  X7: WF (confidence: 1.000)
  X8: WF (confidence: 1.000)
  X9: Ad (confidence: 1.000)
  X10: Ad (confidence: 1.000)

Neural Network:
Average Prediction Confidence: 0.9927
  X1: UF (confidence: 1.000)
  X2: UF (confidence: 1.000)
  X3: UF (confidence: 0.989)
  X4: UF (confidence: 0.980)
  X5: UF (confidence: 0.990)
  X6: WF (confidence: 1.000)
  X7: WF (confidence: 1.000)
  X8: WF (confidence: 1.000)
  X9: Ad (confidence: 0.968)
  X10: Ad (confidence: 0.998)

Decision Tree:
Average Prediction Confidence: 1.0000
  X1: UF (confidence: 1.000)
  X2: UF (confidence: 1.000)
  X3: UF (confidence: 1.000)
  X4: UF (confidence: 1.000)
  X5: UF (confidence: 1.000)
  X6: WF (confidence: 1.000)
  X7: WF (confidence: 1.000)
  X8: WF (confidence: 1.000)
  X9: Ad (confidence: 1.000)
  X10: Ad (confidence: 1.000)

Random Forest (Tuned):
Average Prediction Confidence: 0.9520
  X1: UF (confidence: 1.000)
  X2: UF (confidence: 1.000)
  X3: UF (confidence: 0.960)
  X4: UF (confidence: 0.980)
  X5: UF (confidence: 0.980)
  X6: WF (confidence: 0.800)
  X7: WF (confidence: 1.000)
  X8: WF (confidence: 0.800)
  X9: Ad (confidence: 1.000)
  X10: Ad (confidence: 1.000)

Support Vector Machine (Tuned):
Average Prediction Confidence: 0.8696
  X1: UF (confidence: 0.624)
  X2: UF (confidence: 0.733)
  X3: UF (confidence: 0.731)
  X4: UF (confidence: 0.907)
  X5: UF (confidence: 0.899)
  X6: WF (confidence: 0.955)
  X7: WF (confidence: 0.976)
  X8: WF (confidence: 0.914)
  X9: Ad (confidence: 0.987)
  X10: Ad (confidence: 0.970)

Gradient Boosting (Tuned):
Average Prediction Confidence: 0.5835
  X1: UF (confidence: 0.546)
  X2: UF (confidence: 0.546)
  X3: UF (confidence: 0.546)
  X4: UF (confidence: 0.546)
  X5: UF (confidence: 0.546)
  X6: WF (confidence: 0.551)
  X7: WF (confidence: 0.603)
  X8: WF (confidence: 0.551)
  X9: Ad (confidence: 0.699)
  X10: Ad (confidence: 0.699)

✅ All predictions saved to: enose_analysis_results/data/all_predictions_20250812_133600.csv

==================================================
CREATING PREDICTION VISUALIZATIONS
==================================================
✅ Model confidence plot saved to: enose_analysis_results/plots/08_model_confidence_20250812_133600.png
✅ Prediction distribution plot saved to: enose_analysis_results/plots/09_prediction_distribution_20250812_133600.png
✅ Model agreement plot saved to: enose_analysis_results/plots/10_model_agreement_20250812_133600.png
✅ Prediction heatmap saved to: enose_analysis_results/plots/11_prediction_heatmap_20250812_133600.png
✅ Confidence distribution plot saved to: enose_analysis_results/plots/12_confidence_dist_1_Decision_Tree_20250812_133600.png
✅ Confidence distribution plot saved to: enose_analysis_results/plots/12_confidence_dist_2_Naive_Bayes_20250812_133600.png
✅ Confidence distribution plot saved to: enose_analysis_results/plots/12_confidence_dist_3_Gradient_Boosting_20250812_133600.png
✅ Per-sample confidence plot saved to: enose_analysis_results/plots/13_per_sample_confidence_20250812_133600.png
✅ Consensus predictions plot saved to: enose_analysis_results/plots/14_consensus_predictions_20250812_133600.png

DETAILED PREDICTION SUMMARY:
==================================================

Most confident model: Decision Tree
Average confidence: 1.0000

CONSENSUS PREDICTIONS:
------------------------------
X1: UF (UNANIMOUS)
X2: UF (UNANIMOUS)
X3: UF (UNANIMOUS)
X4: UF (UNANIMOUS)
X5: UF (UNANIMOUS)
X6: WF (UNANIMOUS)
X7: WF (UNANIMOUS)
X8: WF (UNANIMOUS)
X9: Ad (UNANIMOUS)
X10: Ad (UNANIMOUS)

✅ Consensus predictions saved to: enose_analysis_results/data/consensus_predictions_20250812_133600.csv

============================================================
ANALYSIS SUMMARY
============================================================

Most confident model: Decision Tree
Average Prediction Confidence: 1.0

FINAL PREDICTIONS (using Decision Tree):
----------------------------------------
X1: UF (confidence: 1.000)
X2: UF (confidence: 1.000)
X3: UF (confidence: 1.000)
X4: UF (confidence: 1.000)
X5: UF (confidence: 1.000)
X6: WF (confidence: 1.000)
X7: WF (confidence: 1.000)
X8: WF (confidence: 1.000)
X9: Ad (confidence: 1.000)
X10: Ad (confidence: 1.000)

PREDICTION SUMMARY:
- Ad: 2/10 samples (20.0%)
- UF: 5/10 samples (50.0%)
- WF: 3/10 samples (30.0%)

TOP 5 MOST IMPORTANT SENSOR CHANNELS:
1. ch12: 0.1686
2. ch0: 0.1338
3. ch6: 0.1302
4. ch11: 0.1193
5. ch3: 0.1007

DATASET CHARACTERISTICS:
- Training samples: 130 (WF: 40, Ad: 60, UF: 30)
- Unclassified cocoa bean samples: 10 (X1-X10)
- Sensor channels: 14 (ch0-ch13)
- Training classes: WF, Ad, UF

============================================================
FINAL CLASSIFICATION RESULTS
============================================================
Sample_ID Predicted_Class  Confidence    Model_Used
       X1              UF         1.0 Decision Tree
       X2              UF         1.0 Decision Tree
       X3              UF         1.0 Decision Tree
       X4              UF         1.0 Decision Tree
       X5              UF         1.0 Decision Tree
       X6              WF         1.0 Decision Tree
       X7              WF         1.0 Decision Tree
       X8              WF         1.0 Decision Tree
       X9              Ad         1.0 Decision Tree
      X10              Ad         1.0 Decision Tree

✅ Final classification results saved to: enose_analysis_results/data/final_classification_results_20250812_133600.csv

============================================================
INTERPRETATION:
- WF, Ad, UF likely represent different types/qualities of cocoa beans
- X1-X10 are unclassified cocoa bean samples
- The model predicts which known category each sample belongs to
- Higher confidence scores indicate more reliable predictions
- Consider validating results with domain experts
============================================================

✅ Comprehensive summary report saved to: enose_analysis_results/ANALYSIS_SUMMARY_REPORT_20250812_133600.txt

============================================================
ANALYSIS COMPLETE - ALL RESULTS SAVED
============================================================
📁 Results directory: enose_analysis_results
📊 Individual plots (14 files) saved in: enose_analysis_results/plots
📋 Data files (8 CSV files) saved in: enose_analysis_results/data
📝 Log files saved in: enose_analysis_results/logs
📄 Summary report: ANALYSIS_SUMMARY_REPORT_20250812_133600.txt
============================================================

🎉 All visualizations are now individual, high-quality files!
   Each plot can be used separately in presentations or publications.
